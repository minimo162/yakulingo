@echo off
chcp 65001 > nul
:: ============================================================
:: YakuLingo ワンクリックインストーラー
:: 共有フォルダから実行してください
:: ============================================================

cd /d "%~dp0"

echo.
echo ╔════════════════════════════════════════════════════════╗
echo ║           YakuLingo インストーラー                     ║
echo ╠════════════════════════════════════════════════════════╣
echo ║  このスクリプトは以下を自動的に行います：              ║
echo ║    1. ZIPファイルをローカルにコピー                    ║
echo ║    2. 自動展開                                         ║
echo ║    3. デスクトップにショートカット作成                 ║
echo ╚════════════════════════════════════════════════════════╝
echo.

:: 確認プロンプト
set /p CONFIRM="インストールを開始しますか？ [Y/N]: "
if /i not "%CONFIRM%"=="Y" (
    echo インストールをキャンセルしました。
    timeout /t 3 > nul
    exit /b 0
)

echo.
echo インストールを開始しています...
echo.

powershell -ExecutionPolicy Bypass -File "%~dp0install.ps1"

if errorlevel 1 (
    echo.
    echo ════════════════════════════════════════════════════════
    echo [エラー] インストールに失敗しました。
    echo 管理者にお問い合わせください。
    echo ════════════════════════════════════════════════════════
    pause
    exit /b 1
)

echo.
echo ════════════════════════════════════════════════════════
echo インストールが完了しました！
echo デスクトップの「YakuLingo」ショートカットから起動できます。
echo ════════════════════════════════════════════════════════
echo.
pause
